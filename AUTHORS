Originally written by:
Joris Hermans - http://github.com/jorishermans